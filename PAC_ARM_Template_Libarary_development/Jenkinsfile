pipeline {
  agent any

  environment {
    DIR = "/var/lib/jenkins/workspace/Newco-CTF-PAC-UKSouth/PAC_ARM_Template_Libarary_development"
  }

  stages {

   stage('Az Authentication') {
      steps {
        sh 'az login --service-principal -u d477bc25-9605-4f7b-9d57-183a8023aedd -p Gen7Q~McGigoaFDq1RR_Xm3AwipWq3btGsZ7P -t 2eaefbef-4530-46a0-9c3a-1bae7a45d64d'

      }
    }
    
    stage('Deploy ARM') {
      steps {
        dir("${DIR}"){
          script{
            sh "pwd"
            sh "chmod -R 777 /var/lib/jenkins/workspace/Newco-CTF-PAC-UKSouth/PAC_ARM_Template_Libarary_development"
            sh "./run.sh"
          }
        }
      }
    }
  }
}